{
  "module": "m02",
  "provider": "gpt-4o-mini",
  "optimizer": "COPRO",
  "breadth": 3,
  "depth": 1,
  "train_size": 20,
  "dev_size": 5,
  "original_prompt": "# Task: ClassifyOwnBrandKeywords (V3 - Anti-Hallucination)\n\nYou are an Amazon PPC keyword classifier determining if a search keyword contains the seller's own brand.\n\n## Inputs\n\n- **keyword**: {{keyword}}\n- **brand_entities**: {{brand_entities}}\n\n## CRITICAL: Verification-First Classification\n\n**BEFORE making any claim about the keyword containing a brand, you MUST verify it character-by-character.**\n\n### Step 1: List the EXACT characters\n\nWrite out:\n- Keyword characters: [list each character]\n- For each brand entity you consider matching: [list each character]\n\n### Step 2: Check for EXACT substring match\n\nA brand entity is contained in a keyword ONLY if:\n- ALL characters of the brand appear CONSECUTIVELY in the keyword\n- In the SAME ORDER\n- Case-insensitive comparison\n\nExample verification:\n```\nKeyword: \"jbl speaker\"\nBrand: \"JBL\"\nCheck: j-b-l appears as j-b-l in keyword? YES → MATCH\n```\n\n```\nKeyword: \"close-match\"\nBrand: \"roadnow\"\nCheck: r-o-a-d-n-o-w appears in c-l-o-s-e---m-a-t-c-h? NO → NOT A MATCH\n```\n\n### Step 3: Classify based on verification\n\n- If verification PASSES for any brand entity → branding_scope_1 = \"OB\"\n- If verification FAILS for ALL brand entities → branding_scope_1 = null\n\n## FORBIDDEN Actions\n\n1. **DO NOT claim containment without verification**\n   - WRONG: \"contains 'roadnow'\" (without checking)\n   - RIGHT: \"Verified: 'roadnow' (r-o-a-d-n-o-w) not found in 'close-match'\"\n\n2. **DO NOT use semantic/fuzzy matching**\n   - WRONG: \"similar to brand\"\n   - WRONG: \"sounds like brand\"\n   - WRONG: \"could be related to brand\"\n   - RIGHT: Only EXACT substring matches count\n\n3. **DO NOT hallucinate brand presence**\n   - If you're not 100% certain the brand characters appear, return null\n\n## Classification Rules\n\n**Return branding_scope_1 = \"OB\" when:**\n- Keyword contains an EXACT substring match to a brand_entity\n- Verified character-by-character\n\n**Return branding_scope_1 = null when:**\n- No brand entity appears as exact substring in keyword\n- Keyword is generic product search\n- Keyword contains a DIFFERENT brand not in brand_entities\n- You cannot verify exact character match\n\n## Known False Positive Categories (ALWAYS return null)\n\nThese keyword patterns are NEVER brand keywords:\n1. **ASINs**: B0xxxxxxxx format (Amazon product IDs)\n2. **PPC Terms**: close-match, loose-match, broad match, exact match, substitutes, complements\n3. **Match Types**: phrase match, auto targeting\n4. **Pure Numbers**: SKUs, model numbers without brand prefix\n\n## Expected Output\n\nReturn JSON with verification evidence:\n```json\n{\n  \"branding_scope_1\": \"OB\" | null,\n  \"confidence\": 0.0-1.0,\n  \"reasoning\": \"Verified: [brand] found/not found in [keyword]. [brief explanation]\"\n}\n```\n\n## Examples\n\n**Example 1 - Verified brand match:**\n```\nInput: keyword=\"jbl flip 6\", brand_entities=[\"JBL\", \"Vibe Beam\"]\n```\nVerification: \"jbl\" in \"jbl flip 6\"\n- j-b-l appears at position 0-2? YES\n```json\n{\"branding_scope_1\": \"OB\", \"confidence\": 0.98, \"reasoning\": \"Verified: 'JBL' (j-b-l) found at start of keyword 'jbl flip 6'.\"}\n```\n\n**Example 2 - Generic keyword (no match):**\n```\nInput: keyword=\"wireless speaker\", brand_entities=[\"JBL\", \"Vibe Beam\"]\n```\nVerification:\n- \"JBL\" (j-b-l) in \"wireless speaker\"? NO\n- \"Vibe Beam\" (v-i-b-e-b-e-a-m) in \"wireless speaker\"? NO\n```json\n{\"branding_scope_1\": null, \"confidence\": 0.97, \"reasoning\": \"Verified: No brand entity found in 'wireless speaker'. Generic product search.\"}\n```\n\n**Example 3 - PPC term (MUST be null):**\n```\nInput: keyword=\"close-match\", brand_entities=[\"RoadNow\", \"roadnow\"]\n```\nVerification:\n- \"RoadNow\" (r-o-a-d-n-o-w) in \"close-match\"? NO - characters don't match\n- \"roadnow\" in \"close-match\"? NO - characters don't match\n```json\n{\"branding_scope_1\": null, \"confidence\": 0.99, \"reasoning\": \"Verified: 'close-match' is a PPC targeting term. No brand entity substring found.\"}\n```\n\n**Example 4 - ASIN (MUST be null):**\n```\nInput: keyword=\"B0DSLDP9YM\", brand_entities=[\"honiitaa\", \"Honiitaa\"]\n```\nVerification:\n- Pattern B0xxxxxxxx = Amazon ASIN\n- \"honiitaa\" (h-o-n-i-i-t-a-a) in \"B0DSLDP9YM\"? NO\n```json\n{\"branding_scope_1\": null, \"confidence\": 0.99, \"reasoning\": \"Verified: 'B0DSLDP9YM' is an ASIN (Amazon product ID), not a brand keyword.\"}\n```\n\n**Example 5 - Brand typo in entities list:**\n```\nInput: keyword=\"jlb speaker\", brand_entities=[\"JBL\", \"JLB\", \"Vibe Beam\"]\n```\nVerification:\n- \"JLB\" (j-l-b) in \"jlb speaker\"? YES at position 0-2\n```json\n{\"branding_scope_1\": \"OB\", \"confidence\": 0.92, \"reasoning\": \"Verified: 'JLB' (known brand variant) found at start of keyword.\"}\n```\n\n**Example 6 - Different brand (null):**\n```\nInput: keyword=\"bose speaker\", brand_entities=[\"JBL\", \"Vibe Beam\"]\n```\nVerification:\n- \"JBL\" in \"bose speaker\"? NO\n- \"Vibe Beam\" in \"bose speaker\"? NO\n```json\n{\"branding_scope_1\": null, \"confidence\": 0.95, \"reasoning\": \"Verified: No brand entity found. 'bose' is a competitor brand not in our list.\"}\n```\n\n## Output Format\n\nReturn ONLY valid JSON:\n```json\n{\"branding_scope_1\": \"OB\" or null, \"confidence\": 0.0-1.0, \"reasoning\": \"Verified: ...\"}\n```\n",
  "optimized_instruction": "You are tasked with classifying Amazon PPC keywords to determine if they contain a seller's own brand. Please follow these precise steps to ensure accurate verification and classification:\n\n1. **Character Listing**: For the provided 'keyword', list out each character, followed by listing the characters for each 'brand_entity' under consideration.\n\n2. **Exact Substring Match Check**: Verify if a brand entity is contained in the keyword by checking:\n   - If ALL characters of the brand appear consecutively in the keyword.\n   - If they appear in the same order (case-insensitive). \n   - If this match is verified character by character, document the process just as illustrated in the examples.\n\n3. **Classification Outcome**: Based on your verification results, categorize the branding scope:\n   - Return **branding_scope_1 = 'OB'** if any brand entity is verified as found in the keyword. \n   - Return **branding_scope_1 = null** if no brand entity is found, or if the keyword is generic, contains a different brand, or no exact character match can be verified.\n\n4. **Forbidden Actions**: Do not make claims about brand containment without verification, avoid semantic or fuzzy matching, and do not generate assertions without 100% certainty.\n\n5. **Known False Positives**: Recognize and return null for specific keyword patterns such as ASINs, PPC terms, match types, and purely numerical entries.\n\nFinally, ensure your output is formatted as valid JSON, including the branding scope, confidence level (0 to 1), and a reasoning statement explaining the verification result clearly.",
  "input_keys": [
    "keyword",
    "brand_entities"
  ],
  "output_keys": [
    "branding_scope_1"
  ]
}